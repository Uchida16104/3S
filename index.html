<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="icon" type="image/png" sizes="32x32" href="./3S.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./3S.png">
  <link rel="apple-touch-icon" href="./3S.png" sizes="180x180">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="./3S.png">

  <title>ğŸ’¬ 3S - å ±é€£ç›¸ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- HTMX -->
  <script src="https://unpkg.com/htmx.org"></script>

  <!-- hyperscript -->
  <script src="https://unpkg.com/hyperscript.org"></script>

  <!-- html2canvas & jsPDF -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</head>

<body class="bg-gray-50 text-gray-900 min-h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-blue-700 text-white p-4">
    <div class="max-w-4xl mx-auto space-y-1">
      <h1 class="text-xl font-bold">ğŸ’¬ 3S - å ±é€£ç›¸ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
      <p class="text-sm">
        è² è·æœ€å°åŒ–ãƒ»çµè«–å…ˆè¡Œå‹ï¼ˆPREP Ã— DESC Ã— SDS Ã— 5W3Hï¼‰
      </p>
    </div>
  </header>

  <!-- Main -->
  <main class="flex-1 max-w-4xl mx-auto w-full p-4 sm:p-6 space-y-6">

    <!-- Purpose -->
    <section class="bg-white p-4 sm:p-6 rounded shadow">
      <p class="text-sm text-gray-700 leading-relaxed">
        æœ¬ãƒ„ãƒ¼ãƒ«ã¯ã€ç¥çµŒç™ºé”ç—‡ã®ã‚ã‚‹æ–¹ã€ä»–äººã¨ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å›°ã‚Šäº‹ã‚’ãŠæŒã¡ã®æ–¹ãŒã€
        <strong>å®Ÿéš›ã®å°±åŠ´ç’°å¢ƒã‚„æ—¥å¸¸ã®ç”Ÿæ´»å ´é¢ã§ã‚‚é€šç”¨ã™ã‚‹ç°¡æ½”ãªå ±é€£ç›¸</strong>
        ã‚’èº«ã«ã¤ã‘ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚
      </p>
      <p class="text-[13px] text-gray-600">
        ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯
        <a
          hx-on:click="window.location.href='https://github.com/Uchida16104/3S/blob/main/README.md'"
          class="no-underline hover:underline text-blue-600"
          >
          ã“ã¡ã‚‰ï¼ˆREADME.mdï¼‰
        </a>
      </p>
    </section>

    <!-- External Link (HTMX) -->
    <section class="bg-white p-4 sm:p-6 rounded shadow flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
      <p class="text-sm text-gray-700">
        ä¸Šä½æ¦‚å¿µãƒ„ãƒ¼ãƒ«ï¼š
        <span class="font-semibold">
          <a style="text-decoration: none; text-align: center; color: blue; font-weight: bold;" hx-on:click="window.location.href='https://github.com/Uchida16104/3M'">
            3M
          </a>
        </span>
        ï¼ˆè‡ªå·±è¡¨ç¾æ”¯æ´ã‚¢ãƒ—ãƒªï¼‰
      </p>
      <button class="bg-blue-600 text-white px-4 py-2 rounded w-full sm:w-auto" hx-on:click="window.location.href='https://uchida16104.github.io/3M'">
        3M ã¸ç§»å‹•
      </button>
    </section>

    <!-- Input Form -->
    <section class="bg-white p-4 sm:p-6 rounded shadow space-y-4">
      <h2 class="font-semibold text-lg">å…¥åŠ›</h2>

      <!-- Subject -->
      <div class="flex flex-col sm:flex-row gap-2">
        <select id="subjectType" class="border rounded p-2 w-full sm:w-48">
          <option>å ±å‘Š</option>
          <option>é€£çµ¡</option>
          <option>ç›¸è«‡</option>
          <option>ç·Šæ€¥å ±å‘Š</option>
          <option>ç·Šæ€¥é€£çµ¡</option>
          <option>ç·Šæ€¥ç›¸è«‡</option>
          <option>é‡è¦å ±å‘Š</option>
          <option>é‡è¦é€£çµ¡</option>
          <option>é‡è¦ç›¸è«‡</option>
        </select>
        <input
          id="subjectText"
          type="text"
          placeholder="ä»¶å"
          class="border rounded p-2 flex-1"
        />
      </div>

      <!-- Core Fields -->
      <textarea id="conclusion" class="border rounded p-2 w-full" rows="2" placeholder="çµè«–ï¼ˆæœ€åˆã«1æ–‡ã§ï¼‰"></textarea>
      <textarea id="fact" class="border rounded p-2 w-full" rows="3" placeholder="äº‹å®Ÿï¼ˆå®¢è¦³çš„ãƒ»è¦³æ¸¬å¯èƒ½ãªå†…å®¹ï¼‰"></textarea>
      <textarea id="impact" class="border rounded p-2 w-full" rows="2" placeholder="å½±éŸ¿ï¼ˆæ¥­å‹™ãƒ»ç´æœŸãƒ»å“è³ªã¸ã®å½±éŸ¿ï¼‰"></textarea>
      <textarea id="request" class="border rounded p-2 w-full" rows="2" placeholder="è¦æœ›ï¼ˆå…·ä½“çš„ãªä¾é ¼ãƒ»é¸æŠè‚¢ï¼‰"></textarea>

      <!-- Name & Email -->
      <div class="flex flex-col sm:flex-row gap-2">
        <input id="name" type="text" placeholder="æ°å" class="border rounded p-2 flex-1" />
        <input id="email" type="email" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆä¸‹æ›¸ãç”¨ï¼‰" class="border rounded p-2 flex-1" />
      </div>

      <!-- Generate Button -->
      <button
        class="bg-blue-600 text-white px-4 py-2 rounded w-full sm:w-auto"
        _="on click call generate()"
      >
        ç”Ÿæˆ
      </button>
    </section>

    <!-- Output -->
    <section class="bg-white p-4 sm:p-6 rounded shadow space-y-4">
      <h2 class="font-semibold text-lg">ç”Ÿæˆçµæœï¼ˆã‚³ãƒ”ãƒ¼å¯èƒ½ï¼‰</h2>

      <pre
        id="output"
        class="bg-gray-100 p-4 rounded whitespace-pre-wrap text-sm overflow-x-auto"
      ></pre>

      <div class="flex flex-col sm:flex-row gap-2">
        <button class="border px-3 py-2 rounded" _="on click call copyText()">ã‚³ãƒ”ãƒ¼</button>
        <button class="border px-3 py-2 rounded" _="on click call exportPDF()">PDFç”Ÿæˆ</button>
        <button class="border px-3 py-2 rounded" _="on click call exportJPEG()">JPEGç”Ÿæˆ</button>
        <button class="border px-3 py-2 rounded" _="on click call draftMail()">ãƒ¡ãƒ¼ãƒ«ä¸‹æ›¸ã</button>
      </div>
    </section>

  </main>

  <!-- Script -->
  <script>
    function generate() {
      const subjectType = document.getElementById('subjectType').value;
      const subjectText = document.getElementById('subjectText').value;
      const conclusion = document.getElementById('conclusion').value;
      const fact = document.getElementById('fact').value;
      const impact = document.getElementById('impact').value;
      const request = document.getElementById('request').value;
      const name = document.getElementById('name').value;

      const result =
`ã€${subjectType}ã€‘${subjectText}

ã€çµè«–ã€‘
${conclusion}

ã€äº‹å®Ÿã€‘
${fact}

ã€å½±éŸ¿ã€‘
${impact}

ã€è¦æœ›ã€‘
${request}

â€•â€•â€•â€•â€•â€•â€•â€•â€•â€•
${name}`;

      document.getElementById('output').textContent = result;
    }

    function copyText() {
      navigator.clipboard.writeText(
        document.getElementById('output').textContent
      );
    }

    async function exportPDF() {
      const { jsPDF } = window.jspdf;
      const canvas = await html2canvas(document.getElementById('output'));
      const imgData = canvas.toDataURL('image/png');
      const pdf = new jsPDF();
      pdf.addImage(imgData, 'PNG', 10, 10, 190, 0);
      pdf.save('report.pdf');
    }

    async function exportJPEG() {
      const canvas = await html2canvas(document.getElementById('output'));
      const link = document.createElement('a');
      link.download = 'report.jpg';
      link.href = canvas.toDataURL('image/jpeg');
      link.click();
    }

    function draftMail() {
      const email = document.getElementById('email').value;
      const subject =
        document.getElementById('subjectType').value +
        ' ' +
        document.getElementById('subjectText').value;
      const body = encodeURIComponent(
        document.getElementById('output').textContent
      );

      window.location.href =
        `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${body}`;
    }
  </script>

</body>
</html>
